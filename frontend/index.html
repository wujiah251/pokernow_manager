<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾·å·æ‰‘å…‹æ•°æ®ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">â™ </span>
                    <h1>æ‰‘å…‹ä¿±ä¹éƒ¨</h1>
                </div>
                <nav class="nav-tabs">
                    <button
                        v-for="(tab, index) in tabs"
                        :key="index"
                        :class="['nav-tab', { active: currentTab === index }]"
                        @click="currentTab = index"
                    >
                        {{ tab }}
                    </button>
                </nav>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content">
            <!-- Tab 1: ç©å®¶æ˜ å°„ -->
            <div v-show="currentTab === 0" class="tab-content">
                <div class="section-header">
                    <h2>ç©å®¶æ˜ å°„</h2>
                    <p class="subtitle">ç©å®¶ ID ä¸æ˜µç§°ã€åˆ«åçš„å¯¹åº”å…³ç³»</p>
                </div>

                <!-- æ–°å¢æ˜ å°„è¡¨å• -->
                <div class="add-player-panel">
                    <h3>æ–°å¢æ˜ å°„</h3>
                    <div class="add-form">
                        <div class="form-group">
                            <label>åˆ«å</label>
                            <input type="text" v-model="newPlayer.alias" placeholder="è¾“å…¥åˆ«å">
                        </div>
                        <div class="form-group">
                            <label>æ˜µç§°</label>
                            <input type="text" v-model="newPlayer.nickname" placeholder="è¾“å…¥æ˜µç§°">
                        </div>
                        <button class="btn btn-primary" @click="addPlayer" :disabled="!newPlayer.alias || !newPlayer.nickname || adding">
                            {{ adding ? 'æ·»åŠ ä¸­...' : 'æ·»åŠ ' }}
                        </button>
                    </div>
                    <div v-if="addResult" :class="['upload-result', addResult.success ? 'success' : 'error']">
                        {{ addResult.message }}
                    </div>
                </div>

                <!-- åˆå¹¶/é‡å‘½åç©å®¶ -->
                <div class="add-player-panel">
                    <h3>åˆå¹¶ç©å®¶</h3>
                    <p class="subtitle">å°†ä¸€ä¸ªç©å®¶çš„æ‰€æœ‰å†å²è®°å½•åˆå¹¶åˆ°å¦ä¸€ä¸ªç©å®¶</p>
                    <div class="add-form">
                        <div class="form-group">
                            <label>åŸæ˜µç§°</label>
                            <select v-model="mergeForm.oldNickname">
                                <option value="">é€‰æ‹©è¦åˆå¹¶çš„ç©å®¶</option>
                                <option v-for="p in playerList" :key="p" :value="p">{{ p }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ç›®æ ‡æ˜µç§°</label>
                            <select v-model="mergeForm.newNickname">
                                <option value="">é€‰æ‹©ç›®æ ‡ç©å®¶</option>
                                <option v-for="p in playerList" :key="p" :value="p">{{ p }}</option>
                            </select>
                        </div>
                        <button class="btn btn-warning" @click="mergePlayerData" :disabled="!mergeForm.oldNickname || !mergeForm.newNickname || merging">
                            {{ merging ? 'åˆå¹¶ä¸­...' : 'åˆå¹¶' }}
                        </button>
                    </div>
                    <div v-if="mergeResult" :class="['upload-result', mergeResult.success ? 'success' : 'error']">
                        {{ mergeResult.message }}
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>æ˜µç§°</th>
                                <th>åˆ«å</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="player in players" :key="player.id">
                                <td class="nickname">{{ player.nickname }}</td>
                                <td class="alias">{{ player.alias || '-' }}</td>
                                <td class="date">{{ formatDate(player.created_at) }}</td>
                                <td>
                                    <button class="btn btn-danger btn-small" @click="deletePlayerMapping(player.nickname)">åˆ é™¤</button>
                                </td>
                            </tr>
                            <tr v-if="players.length === 0">
                                <td colspan="4" class="empty-row">æš‚æ— æ•°æ®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab 2: ç»Ÿè®¡æŸ¥è¯¢ -->
            <div v-show="currentTab === 2" class="tab-content">
                <div class="section-header">
                    <h2>ç»Ÿè®¡æŸ¥è¯¢</h2>
                    <p class="subtitle">ç©å®¶æ‰‘å…‹æ•°æ®ç»Ÿè®¡ï¼ˆVPIP, PFR, 3-Bet ç­‰ï¼‰, C-Bet</p>
                </div>

                <!-- ç»Ÿè®¡ç­›é€‰å’Œä¸Šä¼  -->
                <div class="query-panel">
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="date" v-model="statsStartDate" @change="loadStats">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="date" v-model="statsEndDate" @change="loadStats">
                    </div>
                    <div class="form-group">
                        <label>ç©å®¶ï¼ˆå¯é€‰ï¼‰</label>
                        <select v-model="statsPlayer" @change="loadStats">
                            <option value="">å…¨éƒ¨ç©å®¶</option>
                            <option v-for="p in pokerPlayers" :key="p" :value="p">{{ p }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <button class="btn btn-primary" @click="loadStats">åˆ·æ–°ç»Ÿè®¡</button>
                    </div>
                </div>

                <!-- ä¸Šä¼  poker.csv -->
                <div class="upload-section">
                    <h3>ä¸Šä¼ æ‰‘å…‹æ—¥å¿—</h3>
                    <div class="upload-form">
                        <div class="form-group">
                            <label>æ—¥æœŸ</label>
                            <input type="date" v-model="pokerUploadDate">
                        </div>
                        <div class="form-group">
                            <label>é€‰æ‹©æ–‡ä»¶</label>
                            <input type="file" ref="pokerFile" accept=".csv" @change="handlePokerFileSelect">
                        </div>
                        <div class="form-group">
                            <button class="btn btn-success" @click="uploadPokerFile" :disabled="!pokerFile || !pokerUploadDate || uploadingPoker">
                                {{ uploadingPoker ? 'ä¸Šä¼ ä¸­...' : 'ä¸Šä¼ ' }}
                            </button>
                        </div>
                    </div>
                    <div v-if="pokerUploadResult" class="upload-result" :class="pokerUploadResult.success ? 'success' : 'error'">
                        {{ pokerUploadResult.message }}
                    </div>
                </div>

                <!-- å·²å¤„ç†çš„æ—¥æœŸåˆ—è¡¨ -->
                <div class="processed-dates" v-if="pokerDates.length > 0">
                    <h3>å·²å¤„ç†çš„æ•°æ®æ—¥æœŸ</h3>
                    <div class="date-tags">
                        <span v-for="date in pokerDates" :key="date" class="date-tag">{{ date }}</span>
                    </div>
                    <div class="form-group" style="margin-top: 10px;">
                        <button class="btn btn-danger" @click="clearPokerData">æ¸…é™¤æ‰€æœ‰æ•°æ®</button>
                    </div>
                </div>

                <!-- åŠ è½½çŠ¶æ€ -->
                <div v-if="statsLoading" class="loading">
                    <div class="loading-spinner"></div>
                    <p>åŠ è½½ç»Ÿè®¡æ•°æ®ä¸­...</p>
                </div>

                <!-- ç»Ÿè®¡è¡¨æ ¼ -->
                <div v-else-if="stats.length > 0" class="stats-container">
                    <div class="stats-table-wrapper">
                        <table class="data-table stats-table">
                            <thead>
                                <tr>
                                    <th>ç©å®¶</th>
                                    <th @click="toggleStatsSort('hands')" class="sortable">
                                        æ‰‹ç‰Œ <span v-if="statsSortField === 'hands'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('vpip')" class="sortable">
                                        VPIP <span v-if="statsSortField === 'vpip'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('pfr')" class="sortable">
                                        PFR <span v-if="statsSortField === 'pfr'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('three_bet')" class="sortable">
                                        3-Bet <span v-if="statsSortField === 'three_bet'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('fold_to_3bet')" class="sortable">
                                        F3B <span v-if="statsSortField === 'fold_to_3bet'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('c_bet')" class="sortable">
                                        C-Bet <span v-if="statsSortField === 'c_bet'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('fold_to_cbet')" class="sortable">
                                        FCB <span v-if="statsSortField === 'fold_to_cbet'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('af')" class="sortable">
                                        AF <span v-if="statsSortField === 'af'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('wtsd')" class="sortable">
                                        WTSD <span v-if="statsSortField === 'wtsd'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('wtsd_won')" class="sortable">
                                        W$SD <span v-if="statsSortField === 'wtsd_won'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('wwsf')" class="sortable">
                                        WWSF <span v-if="statsSortField === 'wwsf'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                    <th @click="toggleStatsSort('wwsr')" class="sortable">
                                        WWSR <span v-if="statsSortField === 'wwsr'">{{ statsSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="stat in sortedStats" :key="stat.id" @click="selectedStatsPlayer = stat" class="stats-row">
                                    <td class="player-name">{{ stat.name }}</td>
                                    <td class="stat-number">{{ stat.hands }}</td>
                                    <td :class="['stat-number', getVpipClass(stat.vpip)]">{{ stat.vpip }}%</td>
                                    <td class="stat-number">{{ stat.pfr }}%</td>
                                    <td class="stat-number">{{ stat.three_bet }}%</td>
                                    <td class="stat-number">{{ stat.fold_to_3bet }}%</td>
                                    <td class="stat-number">{{ stat.c_bet }}%</td>
                                    <td class="stat-number">{{ stat.fold_to_cbet }}%</td>
                                    <td :class="['stat-number', getAfClass(stat.af)]">{{ stat.af }}</td>
                                    <td class="stat-number">{{ stat.wtsd }}%</td>
                                    <td class="stat-number">{{ stat.wtsd_won }}%</td>
                                    <td class="stat-number">{{ stat.wwsf }}%</td>
                                    <td class="stat-number">{{ stat.wwsr }}%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ç©å®¶è¯¦æƒ…å¼¹çª— -->
                    <div v-if="selectedStatsPlayer" class="modal-overlay" @click.self="selectedStatsPlayer = null">
                        <div class="modal-content player-detail-modal">
                            <div class="modal-header">
                                <div class="player-info">
                                    <div class="player-avatar">{{ selectedStatsPlayer.name.substring(0, 2).toUpperCase() }}</div>
                                    <div>
                                        <h3>{{ selectedStatsPlayer.name }}</h3>
                                        <p>æ‰‹ç‰Œæ•°: {{ selectedStatsPlayer.hands }}</p>
                                    </div>
                                </div>
                                <button class="close-btn" @click="selectedStatsPlayer = null">&times;</button>
                            </div>
                            <div class="modal-body">
                                <!-- é«˜çº§ç»Ÿè®¡æ•°æ® -->
                                <div class="stats-section">
                                    <h4>é«˜çº§ç»Ÿè®¡</h4>
                                    <div class="stats-grid">
                                        <div class="stat-box">
                                            <span class="stat-label">4-Bet %</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.four_bet }}%</span>
                                        </div>
                                        <div class="stat-box">
                                            <span class="stat-label">Fold to 4-Bet</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.fold_to_4bet }}%</span>
                                        </div>
                                        <div class="stat-box">
                                            <span class="stat-label">5-Bet %</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.five_bet }}%</span>
                                        </div>
                                        <div class="stat-box">
                                            <span class="stat-label">Fold to 5-Bet</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.fold_to_5bet }}%</span>
                                        </div>
                                        <div class="stat-box">
                                            <span class="stat-label">Fold to 3-Bet</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.fold_to_3bet }}%</span>
                                        </div>
                                        <div class="stat-box">
                                            <span class="stat-label">W$SD %</span>
                                            <span class="stat-value">{{ selectedStatsPlayer.wtsd_won }}%</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- ä½ç½®ç»Ÿè®¡ -->
                                <div class="stats-section" v-if="selectedStatsPlayer.position_stats && Object.keys(selectedStatsPlayer.position_stats).length > 0">
                                    <h4>ä½ç½®ç»Ÿè®¡</h4>
                                    <div class="position-table-wrapper">
                                        <table class="data-table">
                                            <thead>
                                                <tr>
                                                    <th>ä½ç½®</th>
                                                    <th>æ‰‹ç‰Œ</th>
                                                    <th>VPIP</th>
                                                    <th>PFR</th>
                                                    <th>3-Bet</th>
                                                    <th>F3B</th>
                                                    <th>4-Bet</th>
                                                    <th>F4B</th>
                                                    <th>C-Bet</th>
                                                    <th>FCB</th>
                                                    <th>AF</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr v-for="(posStat, pos) in selectedStatsPlayer.position_stats" :key="pos">
                                                    <td class="position-name">{{ pos }}</td>
                                                    <td>{{ posStat.hands }}</td>
                                                    <td>{{ posStat.vpip }}%</td>
                                                    <td>{{ posStat.pfr }}%</td>
                                                    <td>{{ posStat.three_bet }}%</td>
                                                    <td>{{ posStat.fold_to_3bet }}%</td>
                                                    <td>{{ posStat.four_bet }}%</td>
                                                    <td>{{ posStat.fold_to_4bet }}%</td>
                                                    <td>{{ posStat.c_bet }}%</td>
                                                    <td>{{ posStat.fold_to_cbet }}%</td>
                                                    <td>{{ posStat.af }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ— æ•°æ® -->
                <div v-else class="coming-soon">
                    <div class="coming-soon-icon">ğŸ“Š</div>
                    <h3>æš‚æ— ç»Ÿè®¡æ•°æ®</h3>
                    <p>è¯·å…ˆä¸Šä¼ æ‰‘å…‹æ—¥å¿—æ–‡ä»¶</p>
                </div>
            </div>

            <!-- Tab 3: PnL æŸ¥è¯¢ (åŸæ¥çš„ç´¢å¼•2ï¼Œç°åœ¨å˜æˆ3) -->
            <div v-show="currentTab === 1" class="tab-content">
                <div class="section-header">
                    <h2>PnL æŸ¥è¯¢</h2>
                    <p class="subtitle">æ¯æ—¥ç›ˆäºç»Ÿè®¡ä¸ç´¯è®¡æ›²çº¿</p>
                </div>

                <!-- æŸ¥è¯¢æ¡ä»¶ -->
                <div class="query-panel">
                    <div class="form-group">
                        <label>æ—¥æœŸ</label>
                        <select v-model="selectedDate" @change="loadPnl">
                            <option v-for="date in dates" :key="date" :value="date">{{ date }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ç©å®¶ï¼ˆå¯é€‰ï¼‰</label>
                        <select v-model="selectedPlayer" @change="loadPnl">
                            <option value="">å…¨éƒ¨ç©å®¶</option>
                            <option v-for="p in playerList" :key="p" :value="p">{{ p }}</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" @click="loadPnl">æŸ¥è¯¢</button>
                </div>

                <!-- PnL è¡¨æ ¼ -->
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th @click="toggleSort('date')" class="sortable">
                                    æ—¥æœŸ <span v-if="pnlSortColumn === 'date'">{{ pnlSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                </th>
                                <th @click="toggleSort('player_nickname')" class="sortable">
                                    ç©å®¶ <span v-if="pnlSortColumn === 'player_nickname'">{{ pnlSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                </th>
                                <th @click="toggleSort('total_net')" class="sortable">
                                    å‡€ç›ˆäº <span v-if="pnlSortColumn === 'total_net'">{{ pnlSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                </th>
                                <th @click="toggleSort('cumulative_net')" class="sortable">
                                    ç´¯è®¡ç›ˆäº <span v-if="pnlSortColumn === 'cumulative_net'">{{ pnlSortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="record in sortedPnlRecords" :key="record.id" :class="getPnLClass(record.total_net)">
                                <td>{{ record.date }}</td>
                                <td class="nickname">{{ record.player_nickname }}</td>
                                <td class="pnl-value">{{ formatMoney(record.total_net) }}</td>
                                <td class="pnl-value">{{ pnlCumulative[record.player_nickname] !== undefined ? formatMoney(pnlCumulative[record.player_nickname]) : '-' }}</td>
                            </tr>
                            <!-- åˆè®¡è¡Œ -->
                            <tr v-if="pnlTotal" class="total-row">
                                <td></td>
                                <td class="nickname">{{ pnlTotal.player_nickname }}</td>
                                <td class="pnl-value" :class="getPnLClass(pnlTotal.total_net)">{{ formatMoney(pnlTotal.total_net) }}</td>
                                <td>-</td>
                            </tr>
                            <tr v-if="sortedPnlRecords.length === 0">
                                <td colspan="4" class="empty-row">æš‚æ— æ•°æ®</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- ç´¯è®¡æ›²çº¿å›¾ -->
                <div class="chart-section">
                    <h3>ç´¯è®¡ç›ˆäºæ›²çº¿</h3>
                    <div class="chart-query-panel">
                        <div class="form-group">
                            <label>å¼€å§‹æ—¥æœŸ</label>
                            <select v-model="chartStartDate">
                                <option v-for="date in dates" :key="date" :value="date">{{ date }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ç»“æŸæ—¥æœŸ</label>
                            <select v-model="chartEndDate">
                                <option v-for="date in dates" :key="date" :value="date">{{ date }}</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å•ç©å®¶</label>
                            <select v-model="chartPlayer" @change="selectedChartPlayers = []">
                                <option value="">å…¨éƒ¨ç©å®¶</option>
                                <option v-for="p in playerList" :key="p" :value="p">{{ p }}</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" @click="loadChart">æŸ¥è¯¢æ›²çº¿</button>
                    </div>
                    <!-- å¤šé€‰ç©å®¶ -->
                    <div class="multi-select-panel">
                        <label>å¤šé€‰ç©å®¶ï¼ˆæŒ‰ä½Ctrl/Commandå¤šé€‰ï¼‰ï¼š</label>
                        <select multiple v-model="selectedChartPlayers" @change="chartPlayer = ''" style="height: 120px;">
                            <option v-for="p in playerList" :key="p" :value="p">{{ p }}</option>
                        </select>
                    </div>
                    <div class="chart-container">
                        <div id="pnlChart" style="width: 100%; height: 650px;"></div>
                    </div>

                    <!-- ç´¯è®¡PnLè¡¨æ ¼ -->
                    <div class="pnl-table-wrapper" style="margin-top: 50px; margin-bottom: 30px;">
                        <h4>æ‰€æœ‰ç©å®¶ç´¯è®¡ç›ˆäºï¼ˆæˆªæ­¢ {{ chartEndDate }}ï¼‰</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ç©å®¶</th>
                                    <th class="pnl-header">ç´¯è®¡ç›ˆäº</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="player in sortedCumulativePlayers" :key="player.player_nickname">
                                    <td>{{ player.player_nickname }}</td>
                                    <td class="pnl-value" :class="getPnLClass(player.cumulative_net)">{{ formatMoney(player.cumulative_net) }}</td>
                                </tr>
                                <tr class="total-row">
                                    <td>åˆè®¡</td>
                                    <td class="pnl-value" :class="getPnLClass(totalCumulativePnL)">{{ formatMoney(totalCumulativePnL) }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Tab 4: å¯¹å±€æŸ¥è¯¢ -->
            <div v-show="currentTab === 3" class="tab-content">
                <div class="section-header">
                    <h2>å¯¹å±€æŸ¥è¯¢</h2>
                    <p class="subtitle">æŒ‰æ¡ä»¶ç­›é€‰å¯¹å±€è®°å½•</p>
                </div>
                <div class="coming-soon">
                    <div class="coming-soon-icon">ğŸš§</div>
                    <h3>å¼€å‘ä¸­</h3>
                    <p>è¯¥åŠŸèƒ½æš‚æœªå¼€æ”¾ï¼Œæ•¬è¯·æœŸå¾…...</p>
                </div>
            </div>

            <!-- Tab 5: æ•°æ®ä¸Šä¼  -->
            <div v-show="currentTab === 4" class="tab-content">
                <div class="section-header">
                    <h2>æ•°æ®ä¸Šä¼ </h2>
                    <p class="subtitle">ä¸Šä¼ ç‰Œå±€ CSV æ–‡ä»¶åˆ°æ•°æ®åº“</p>
                </div>

                <div class="upload-panel">
                    <div class="form-group">
                        <label>æ—¥æœŸ</label>
                        <input type="date" v-model="uploadDate" class="date-input">
                    </div>
                    <div class="form-group">
                        <label>é€‰æ‹© CSV æ–‡ä»¶</label>
                        <div class="file-upload">
                            <input type="file" id="csvFile" accept=".csv" @change="handleFileSelect">
                            <label for="csvFile" class="file-label">
                                <span v-if="selectedFile">{{ selectedFile.name }}</span>
                                <span v-else>ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</span>
                            </label>
                        </div>
                    </div>
                    <button class="btn btn-primary" @click="uploadFile" :disabled="!selectedFile || !uploadDate || uploading">
                        {{ uploading ? 'ä¸Šä¼ ä¸­...' : 'ä¸Šä¼ ' }}
                    </button>
                </div>

                <div v-if="uploadResult" :class="['upload-result', uploadResult.success ? 'success' : 'error']">
                    {{ uploadResult.message }}
                </div>

                <div class="upload-help">
                    <h4>CSV æ ¼å¼è¦æ±‚</h4>
                    <p>æ–‡ä»¶åº”åŒ…å«ä»¥ä¸‹åˆ—ï¼š</p>
                    <ul>
                        <li>player_nickname - ç©å®¶æ˜µç§°</li>
                        <li>session_start_at - å¼€å§‹æ—¶é—´</li>
                        <li>session_end_at - ç»“æŸæ—¶é—´</li>
                        <li>buy_in - ä¹°å…¥é‡‘é¢</li>
                        <li>buy_out - é€€å‡ºé‡‘é¢</li>
                        <li>stack - å‰©ä½™ç­¹ç </li>
                        <li>net - å‡€ç›ˆäº</li>
                    </ul>
                </div>
            </div>

            <!-- Tab 6: æ•°æ®åˆ é™¤ -->
            <div v-show="currentTab === 5" class="tab-content">
                <div class="section-header">
                    <h2>æ•°æ®åˆ é™¤</h2>
                    <p class="subtitle">åˆ é™¤æŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„ PnL å’Œå¯¹å±€è®°å½•</p>
                </div>

                <div class="delete-panel">
                    <div class="form-group">
                        <label>å¼€å§‹æ—¥æœŸ</label>
                        <input type="date" v-model="deleteStartDate" class="date-input">
                    </div>
                    <div class="form-group">
                        <label>ç»“æŸæ—¥æœŸ</label>
                        <input type="date" v-model="deleteEndDate" class="date-input">
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="deletePnl">
                            <span>åˆ é™¤ PnL è®°å½•</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" v-model="deleteLedger">
                            <span>åˆ é™¤å¯¹å±€è®°å½•</span>
                        </label>
                    </div>
                    <button class="btn btn-danger" @click="deleteRecords" :disabled="!canDelete || deleting">
                        {{ deleting ? 'åˆ é™¤ä¸­...' : 'åˆ é™¤' }}
                    </button>
                </div>

                <div v-if="deleteResult" :class="['upload-result', deleteResult.success ? 'success' : 'error']">
                    {{ deleteResult.message }}
                </div>

                <div class="delete-warning">
                    <h4>âš ï¸ å±é™©æ“ä½œè­¦å‘Š</h4>
                    <p>åˆ é™¤æ“ä½œä¸å¯æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œï¼</p>
                    <ul>
                        <li>åˆ é™¤ PnL è®°å½•å°†æ¸…é™¤æ¯æ—¥æ±‡æ€»æ•°æ®</li>
                        <li>åˆ é™¤å¯¹å±€è®°å½•å°†æ¸…é™¤åŸå§‹å¯¹å±€æ•°æ®</li>
                        <li>å»ºè®®åœ¨åˆ é™¤å‰å¤‡ä»½æ•°æ®åº“</li>
                    </ul>
                </div>
            </div>
        </main>

        <!-- é¡µè„š -->
        <footer class="footer">
            <p>å¾·å·æ‰‘å…‹ 2026 æ˜¥èŠ‚æ•°æ®è®°å½•</p>
        </footer>
    </div>

    <script src="vue.js"></script>
    <script src="echarts.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
